# Generate Technical Documentation for Folder

Analyze code in specified folder and generate/update technical documentation.

## Usage

```
/generate-docs src/features/auth
/generate-docs packages/shared/ui
```

**Argument**: Path to target folder (TARGET_DIR), relative to project root.

---

## What to Analyze

### Include
- Code files: `*.ts`, `*.tsx`, `*.js`, `*.jsx`, `*.py`, `*.go`, etc.
- Logic files: hooks, services, utils, models, controllers, reducers
- Tests: use for understanding behavior (scenarios, invariants), not detailed documentation
- README.md and Markdown files: for context, but **trust code over docs** if conflicts

### Ignore
- `node_modules`, `dist`, `build`, `out`, `.next`, `.turbo`, `.cache`, `coverage`
- Generated files: `*.generated.*`, `*.g.ts`, `*.g.dart`, `*.pb.go`
- Files with comments: `/* AUTO-GENERATED */`, `// generated by ...`
- Binary files: images, fonts, archives
- Config files (`package.json`, `tsconfig.json`, `vite.config.ts`, Dockerfile, CI configs): use only for understanding
  stack, don't document separately

---

## Output

Create/update: `TARGET_DIR/docs/index.md`

### Size Constraint
- **Max ~1000 lines** (at ~120 chars average per line)
- If too large: compress less important details, group similar entities
- Focus value on: architecture overview, key modules, extension rules, critical invariants

---

## Document Structure

All documentation must be in **English**.

```markdown
# [Module Name] – Technical Overview

## 1. Scope and Purpose
Role in project, what it does and doesn't do.

## 2. Directory Structure
Brief tree (2-3 levels), short descriptions per directory.

## 3. Technologies and Dependencies
Languages, frameworks, key libraries.
- Frontend (React/Next/Vue/Angular) - state explicitly
- Backend/API/Library - specify type (API layer, domain layer, shared library)

## 4. Architecture and Data Flow
Layers, responsibilities, how data moves.
For UI: component relationships, state management, API interaction.

## 5. Key Modules and Responsibilities
Key components/services with short descriptions.
Include code examples (5-15 lines) where helpful.

## 6. Extension and Modification Guidelines
How to add features, extension points, invariants to preserve.

## 7. Testing and Quality
How tested, what's covered, key invariants protected by tests.

## 8. Known Trade-offs and Limitations
Conscious compromises, important limitations.

## 9. Summary
Complexity, typical changes, risk areas.
```

---

## Update Rules

If `docs/index.md` already exists:

1. **Don't rewrite from scratch** — analyze existing content first
2. **Identify sections** that:
   - Are outdated and contradict current code
   - Don't reflect important new architecture parts
   - Have substantial gaps
3. **Update only what needs updating**:
   - Fix inaccuracies
   - Add missing key aspects
   - Supplement descriptions where clearly lacking
4. **Preserve user's custom sections** if they:
   - Don't contradict code
   - Contain useful context
5. **Gently align structure** to template without destroying useful content
6. Optionally mark updated sections:
   `> This section has been updated to reflect the current state as of YYYY-MM-DD.`

---

## Analysis Depth

Your analysis should be **deep enough for effective work**, but not fanatical:

- Don't limit to just file structure and names
- **Read key files**:
  - Entry points: `index.tsx`, `main.ts`, `router`, `server.ts`
  - Main components/controllers/services
  - Domain models and types
  - Hooks and shared utilities
- **Use tests** to understand behavior:
  - Which scenarios are primary
  - Which edge cases are explicitly checked
  - Which invariants are protected

**Goal**: Next developer or agent should:
1. First read `docs/index.md`
2. Only then dive into code details

---

## Code Examples in Documentation

- **Short and meaningful** (5-15 lines)
- Show **pattern essence** or typical usage, not entire files
- Don't include large fragments or sensitive data
- All comments and text in examples must be in **English**

```ts
function createUserSession(userId: string): Session {
  // ...
}
```

---

## Command Behavior

1. Analyze TARGET_DIR structure and content with filters
2. Determine module type (frontend/backend/library/mixed) and adapt section content
3. Create or update `TARGET_DIR/docs/index.md`
4. Ensure:
   - File is not excessively large
   - Section structure is clear and stable
   - Document provides practical answers:
     - What is this module?
     - Where is the main logic?
     - How to safely add new functionality?
     - What invariants must not be violated?

---

## Error Handling

If TARGET_DIR doesn't exist or isn't accessible:
- Briefly inform the user
- Don't invent paths or analyze random folders
- Work automatically without clarifying questions in all normal cases
